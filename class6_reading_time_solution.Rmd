---
title: "Class 6"
author: "Telma Peura"
date: "2019 M10 19"
output: html_document
---

# Reading Times Experiment - part 2
### with acknowledgements to Kristian Tyl?n

## preparing R: libraries etc
```{r}
library(pacman)
p_load(tidyverse)

```

# Which features (if any) affect reading time?

In this exercise we will investigate whether different properties of words  affect word-by-word reading times. For this purpose we will use your logfiles from the reading experiment and the MRC Psycholinguistics Database (http://websites.psychology.uwa.edu.au/school/MRCDatabase/uwa_mrc.htm). 


Make sure that you have downloaded the database (called "MRC_database.csv"") from Blackboard to your working directory. Also you should choose a logfile from the reading experiment that you want to work with.

# Step 1: Preparing the dataframe

## 1.1. Import the database into R, as well as your chosen logfile
```{r}
# read the files into R
MRC <- read.csv("MRC_database.csv")

logfile <- read.csv("your_logfile")

```

## 1.2. Capitalize all the words in your logfile. 

If you look at the MRC dataframe, all the words are capitalized. YOu should therefore do the same to your logfile. Check out the function toupper() to do that.

NB! Make sure the word column is called "word" as the word column in the MRC dataframe. You can do it by replacing the old name: 
colnames(your_df)[colnames(your_df)=="old name"] <- "word"

```{r}
# rename the capitalized column to "word"
colnames(logfile)[colnames(logfile)=="Word"] <- "word"

# convert your words into uppercase
logfile$word <- toupper(logfile$word)

# remove punctuation
logfile <- str_replace(logfile$word, "[[:punct:]]", "") #replace by nothing


```

## 1.3. Add word properties from the database to your reading experiment dataframe

Now we are ready to get properties of the words in our text from the database. We do this by merging the two dataframes, the reding experiment logfile and the database using the word column as "key". This means that R will search the database for those words that are identical between the text and the database and add columns for these words to our dataframe. For this we use the function merge(data1, data2, by = "key column").

```{r}
# merge the dfs 
rt <- merge(logfile, MRC, by = "word")

```

# Step 2: Exploring relations

Now we can explore the relation between reading times and different aspects of words using the skills you've learned in EM1 (correlation and scatter plots). 

Perform at least two exploratory tests between reading time and a selected variable from the database. 

```{r}
# check normality
round(pastecs::stat.desc(cbind(df$rt, df$wordlength, " variables you're interested in"), basic = FALSE, norm = TRUE), digits = 2) 

# transform variables if necessary
  # for example for the reading time
df <- df %>% 
  mutate(rt_log = log(rt),
         rt_sqrt = sqrt(rt),
         rt_rec = 1/rt)

# run correlation tests 
cor.test("rt", "variable of interest", method = 'spearman')
  ## use spearman if not normally distributed
```


# Step 3: Visualize with ggplot
```{r}
# some examples for brown frequency

# original data:
ggplot(df, aes(x = brown_freq, y = rt)) +
  geom_point(stat = "summary", fun.y = mean) +
  geom_smooth(method = "lm") + # to get the linear relationship 
  labs( title = " Effect of frequency", x = "Frequency", y =" Reading time (s)")

# log transformed
ggplot(df, aes(x = log_fr, y = log_rt)) +
  geom_point(stat = "summary", fun.y = mean) +
  geom_smooth(method = "lm") + # to get the linear relationship
  labs( title = " Effect of frequency", x = "Frequency (log)", y =" Reading time (log)")
```


In addition, try to compare length of words and word frequency. What do you find and why?

```{r}

cor.test("wordlength", "frequency", method = "choose_method")


ggplot(df, aes(x = word_length, y = brown_fr )) +
  geom_point(stat = "summary", fun.y = mean) +
  geom_smooth(method = "lm") + # to get the linear relationship 
  labs( title = "The relation of length and frequency", x = "Word length", y ="Frequency")
```


